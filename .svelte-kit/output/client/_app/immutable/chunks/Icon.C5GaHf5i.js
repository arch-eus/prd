import{w as O,d as Q}from"./index.D0tE5qX2.js";import{v as ae,s as V,o as le,l as b,a3 as X,A as v,a4 as q,b as x,f as p,a5 as S,i as M,h as ce,u as ue,p as de,q as fe,z as he,a6 as Z,m as E}from"./scheduler.DrDOSCrp.js";import{b as $,t as ee,S as me,i as ge}from"./index.BljkXhbZ.js";function B(e){return e?.length!==void 0?e:Array.from(e)}function Ke(e,t){$(e,1,1,()=>{t.delete(e.key)})}function Qe(e,t,s,n,r,o,l,c,u,f,m,_){let i=e.length,a=o.length,d=i;const k={};for(;d--;)k[e[d].key]=d;const y=[],A=new Map,U=new Map,F=[];for(d=a;d--;){const h=_(r,o,d),g=s(h);let D=l.get(g);D?F.push(()=>D.p(h,t)):(D=f(g,h),D.c()),A.set(g,y[d]=D),g in k&&U.set(g,Math.abs(d-k[g]))}const H=new Set,R=new Set;function I(h){ee(h,1),h.m(c,m),l.set(h.key,h),m=h.first,a--}for(;i&&a;){const h=y[a-1],g=e[i-1],D=h.key,N=g.key;h===g?(m=h.first,i--,a--):A.has(N)?!l.has(D)||H.has(D)?I(h):R.has(N)?i--:U.get(D)>U.get(N)?(R.add(D),I(h)):(H.add(N),i--):(u(g,l),i--)}for(;i--;){const h=e[i];A.has(h.key)||u(h,l)}for(;a;)I(y[a-1]);return ae(F),y}function te(e,t){const s={},n={},r={$$scope:1};let o=e.length;for(;o--;){const l=e[o],c=t[o];if(c){for(const u in l)u in c||(n[u]=1);for(const u in c)r[u]||(s[u]=c[u],r[u]=1);e[o]=c}else for(const u in l)r[u]=1}for(const l in n)l in s||(s[l]=void 0);return s}function Ve(e){return typeof e=="object"&&e!==null?e:{}}function Y(e){return new Promise((t,s)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>s(e.error)})}function De(e,t){const s=indexedDB.open(e);s.onupgradeneeded=()=>s.result.createObjectStore(t);const n=Y(s);return(r,o)=>n.then(l=>o(l.transaction(t,r).objectStore(t)))}let z;function ne(){return z||(z=De("keyval-store","keyval")),z}function _e(e,t=ne()){return t("readonly",s=>Y(s.get(e)))}function ke(e,t,s=ne()){return s("readwrite",n=>(n.put(t,e),Y(n.transaction)))}async function we(){try{return await _e("tasks")||[]}catch(e){return console.error("Error getting tasks:",e),[]}}async function W(e){try{await ke("tasks",e)}catch(t){console.error("Error saving tasks:",t)}}function pe(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}const Xe=6048e5,qe=864e5,se=6e4,re=36e5;function G(e){const t=pe(e);return t.setHours(0,0,0,0),t}function ye(e,t){const n=ve(e);let r;if(n.date){const u=Se(n.date,2);r=Ae(u.restDateString,u.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);const o=r.getTime();let l=0,c;if(n.time&&(l=Ue(n.time),isNaN(l)))return new Date(NaN);if(n.timezone){if(c=Ie(n.timezone),isNaN(c))return new Date(NaN)}else{const u=new Date(o+l),f=new Date(0);return f.setFullYear(u.getUTCFullYear(),u.getUTCMonth(),u.getUTCDate()),f.setHours(u.getUTCHours(),u.getUTCMinutes(),u.getUTCSeconds(),u.getUTCMilliseconds()),f}return new Date(o+l+c)}const T={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Ne=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Te=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,be=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ve(e){const t={},s=e.split(T.dateTimeDelimiter);let n;if(s.length>2)return t;if(/:/.test(s[0])?n=s[0]:(t.date=s[0],n=s[1],T.timeZoneDelimiter.test(t.date)&&(t.date=e.split(T.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const r=T.timezone.exec(n);r?(t.time=n.replace(r[1],""),t.timezone=r[1]):t.time=n}return t}function Se(e,t){const s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(s);if(!n)return{year:NaN,restDateString:""};const r=n[1]?parseInt(n[1]):null,o=n[2]?parseInt(n[2]):null;return{year:o===null?r:o*100,restDateString:e.slice((n[1]||n[2]).length)}}function Ae(e,t){if(t===null)return new Date(NaN);const s=e.match(Ne);if(!s)return new Date(NaN);const n=!!s[4],r=w(s[1]),o=w(s[2])-1,l=w(s[3]),c=w(s[4]),u=w(s[5])-1;if(n)return Oe(t,c,u)?ze(t,c,u):new Date(NaN);{const f=new Date(0);return!Ce(t,o,l)||!je(t,r)?new Date(NaN):(f.setUTCFullYear(t,o,Math.max(r,l)),f)}}function w(e){return e?parseInt(e):1}function Ue(e){const t=e.match(Te);if(!t)return NaN;const s=C(t[1]),n=C(t[2]),r=C(t[3]);return Me(s,n,r)?s*re+n*se+r*1e3:NaN}function C(e){return e&&parseFloat(e.replace(",","."))||0}function Ie(e){if(e==="Z")return 0;const t=e.match(be);if(!t)return 0;const s=t[1]==="+"?-1:1,n=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return Ye(n,r)?s*(n*re+r*se):NaN}function ze(e,t,s){const n=new Date(0);n.setUTCFullYear(e,0,4);const r=n.getUTCDay()||7,o=(t-1)*7+s+1-r;return n.setUTCDate(n.getUTCDate()+o),n}const We=[31,null,31,30,31,30,31,31,30,31,30,31];function oe(e){return e%400===0||e%4===0&&e%100!==0}function Ce(e,t,s){return t>=0&&t<=11&&s>=1&&s<=(We[t]||(oe(e)?29:28))}function je(e,t){return t>=1&&t<=(oe(e)?366:365)}function Oe(e,t,s){return t>=1&&t<=53&&s>=0&&s<=6}function Me(e,t,s){return e===24?t===0&&s===0:s>=0&&s<60&&t>=0&&t<60&&e>=0&&e<25}function Ye(e,t){return t>=0&&t<=59}function Fe(e){if(e)return typeof e=="string"?(e.length===10&&(e=`${e}T12:00:00`),G(ye(e))):G(e)}function P(e){const t=new Date;return{id:e.id||crypto.randomUUID(),title:e.title||"",description:e.description,notes:e.notes,status:e.status||"todo",labels:e.labels||[],dueDate:e.dueDate?Fe(e.dueDate):void 0,completedAt:e.completedAt?new Date(e.completedAt):void 0,order:e.order||0,createdAt:e.createdAt?new Date(e.createdAt):t,updatedAt:e.updatedAt?new Date(e.updatedAt):t,recurrence:e.recurrence||null}}const He=O([]),Re=O(null),Ze={tasks:[],loading:!1,error:null};function Ee(){const{subscribe:e,set:t,update:s}=O(Ze);return{subscribe:e,async init(){s(n=>({...n,loading:!0}));try{const n=await we()||[];t({tasks:n.map(P),loading:!1,error:null})}catch(n){console.error("Failed to initialize task store:",n),t({tasks:[],loading:!1,error:"Failed to load tasks"})}},async addTask(n){s(r=>{const o=P({...n,id:crypto.randomUUID(),createdAt:new Date,updatedAt:new Date,order:r.tasks.length}),l=[...r.tasks,o];return W(l),{...r,tasks:l}})},async updateTask(n,r){s(o=>{const l=o.tasks.map(c=>c.id===n?{...c,...r,updatedAt:new Date}:c);return W(l),{...o,tasks:l}})},async deleteTask(n){s(r=>{const o=r.tasks.filter(l=>l.id!==n);return W(o),{...r,tasks:o}})}}}const ie=Ee(),xe=Q([ie,Re,He],([e,t,s])=>{if(!e.tasks?.length)return[];let n=e.tasks;if(t){const r=new Date(t);r.setHours(0,0,0,0),r<new Date(new Date().setHours(0,0,0,0))?n=n.filter(o=>o.status==="completed"&&o.completedAt&&new Date(o.completedAt).toDateString()===r.toDateString()):n=n.filter(o=>o.status==="todo"&&o.dueDate&&new Date(o.dueDate).toDateString()===r.toDateString())}return s.length&&(n=n.filter(r=>r.labels?.some(o=>s.includes(o)))),n.sort((r,o)=>(r.order||0)-(o.order||0))}),$e=Q(ie,e=>(e.tasks||[]).filter(t=>t.status==="completed").sort((t,s)=>(s.completedAt?.getTime()||0)-(t.completedAt?.getTime()||0)));/**
 * @license lucide-svelte v0.314.0 - ISC

This source code is licensed under the ISC license.
See the LICENSE file in the root directory of this source tree.
 */const J={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};function L(e,t,s){const n=e.slice();return n[10]=t[s][0],n[11]=t[s][1],n}function j(e){let t,s=[e[11]],n={};for(let r=0;r<s.length;r+=1)n=b(n,s[r]);return{c(){t=X(e[10]),this.h()},l(r){t=q(r,e[10],{}),x(t).forEach(p),this.h()},h(){S(t,n)},m(r,o){M(r,t,o)},p(r,o){S(t,n=te(s,[o&32&&r[11]]))},d(r){r&&p(t)}}}function K(e){let t=e[10],s,n=e[10]&&j(e);return{c(){n&&n.c(),s=v()},l(r){n&&n.l(r),s=v()},m(r,o){n&&n.m(r,o),M(r,s,o)},p(r,o){r[10]?t?V(t,r[10])?(n.d(1),n=j(r),t=r[10],n.c(),n.m(s.parentNode,s)):n.p(r,o):(n=j(r),t=r[10],n.c(),n.m(s.parentNode,s)):t&&(n.d(1),n=null,t=r[10])},d(r){r&&p(s),n&&n.d(r)}}}function Be(e){let t,s,n,r,o,l=B(e[5]),c=[];for(let i=0;i<l.length;i+=1)c[i]=K(L(e,l,i));const u=e[9].default,f=le(u,e,e[8],null);let m=[J,e[6],{width:e[2]},{height:e[2]},{stroke:e[1]},{"stroke-width":n=e[4]?Number(e[3])*24/Number(e[2]):e[3]},{class:r=`lucide-icon lucide lucide-${e[0]} ${e[7].class??""}`}],_={};for(let i=0;i<m.length;i+=1)_=b(_,m[i]);return{c(){t=X("svg");for(let i=0;i<c.length;i+=1)c[i].c();s=v(),f&&f.c(),this.h()},l(i){t=q(i,"svg",{width:!0,height:!0,stroke:!0,"stroke-width":!0,class:!0});var a=x(t);for(let d=0;d<c.length;d+=1)c[d].l(a);s=v(),f&&f.l(a),a.forEach(p),this.h()},h(){S(t,_)},m(i,a){M(i,t,a);for(let d=0;d<c.length;d+=1)c[d]&&c[d].m(t,null);ce(t,s),f&&f.m(t,null),o=!0},p(i,[a]){if(a&32){l=B(i[5]);let d;for(d=0;d<l.length;d+=1){const k=L(i,l,d);c[d]?c[d].p(k,a):(c[d]=K(k),c[d].c(),c[d].m(t,s))}for(;d<c.length;d+=1)c[d].d(1);c.length=l.length}f&&f.p&&(!o||a&256)&&ue(f,u,i,i[8],o?fe(u,i[8],a,null):de(i[8]),null),S(t,_=te(m,[J,a&64&&i[6],(!o||a&4)&&{width:i[2]},(!o||a&4)&&{height:i[2]},(!o||a&2)&&{stroke:i[1]},(!o||a&28&&n!==(n=i[4]?Number(i[3])*24/Number(i[2]):i[3]))&&{"stroke-width":n},(!o||a&129&&r!==(r=`lucide-icon lucide lucide-${i[0]} ${i[7].class??""}`))&&{class:r}]))},i(i){o||(ee(f,i),o=!0)},o(i){$(f,i),o=!1},d(i){i&&p(t),he(c,i),f&&f.d(i)}}}function Ge(e,t,s){const n=["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"];let r=Z(t,n),{$$slots:o={},$$scope:l}=t,{name:c}=t,{color:u="currentColor"}=t,{size:f=24}=t,{strokeWidth:m=2}=t,{absoluteStrokeWidth:_=!1}=t,{iconNode:i}=t;return e.$$set=a=>{s(7,t=b(b({},t),E(a))),s(6,r=Z(t,n)),"name"in a&&s(0,c=a.name),"color"in a&&s(1,u=a.color),"size"in a&&s(2,f=a.size),"strokeWidth"in a&&s(3,m=a.strokeWidth),"absoluteStrokeWidth"in a&&s(4,_=a.absoluteStrokeWidth),"iconNode"in a&&s(5,i=a.iconNode),"$$scope"in a&&s(8,l=a.$$scope)},t=E(t),[c,u,f,m,_,i,r,t,l,o]}class et extends me{constructor(t){super(),ge(this,t,Ge,Be,V,{name:0,color:1,size:2,strokeWidth:3,absoluteStrokeWidth:4,iconNode:5})}}export{et as I,Ve as a,Re as b,$e as c,pe as d,B as e,He as f,te as g,xe as h,Xe as i,qe as m,Ke as o,ye as p,G as s,ie as t,Qe as u};
